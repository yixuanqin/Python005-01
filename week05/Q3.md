作业三：请用自己的语言描述如下问题：

1. 在你目前的工作场景中，哪个业务适合使用 rabbitmq？ 引入 rabbitmq 主要解决什么问题?（非相关工作可以以设计淘宝购物和结账功能为例来描述）
以淘宝购物和结账功能为例子，引入rabbitmq主要可以将结账支付、订单生成、购物车清理和物品余量更新等功能进行解耦，通过异步操作完成。防止中间步骤失败而导致整体环节失败，从而影响用户体验。
``` 

```
2. 如何避免消息重复投递或重复消费？
```
重复投递：生产者发送消息给消息队列时，在消息队列确认收到消息的过程中出现了网络波动。导致虽然消息队列已经接收到了生产者的消息，但是生产者没有收到消息队列的确信信息。这个时候生产者就会重新再发送一次这个消息。

重复消费：消费者成功消费消息后，给消息队列发送确认信息的过程中出现了网络波动，消息队列没有收到确认信息。消息队列为了保证消息被消费，消息队列会再次给消费者投递之前的消息。

由于消息的重复投递或者重复消费都是由于网络波动产生，因此无法从根本上避免消息的重复投递或者重复消费。我们可以做到的是保持消息的幂等性。
在生产者产生消息时，消息队列中针对每条生产者发送的消息生成一个该消息的唯一标识，作为去重的依据（消息投递失败并重传），消息队列在消息进入避免重复的消息进入队列；在消费者消费消息时，要求消息体中必须要有一个对于同一业务全局唯一的标示作为去重的依据，避免同一条消息被重复消费。
```

3. 交换机 fanout、direct、topic 有什么区别？
```
fanout：一对多，一个生产者和多个消费者。需要将队列绑定到交换机上。每一条发送到交换机的消息都会被转发到与该交换机绑定的所有队列上。很像子网广播，每台子网内的主机都获得了一份复制的消息。Fanout交换机转发消息是最快的。

direct：一对一的队列，一个生产者和一个消费者。需要将一个队列绑定到交换机上，要求该消息与一个特定的路由键完全匹配。

topic：多对一，多个交换机绑定到一个队列。任何发送到Topic Exchange的消息都会被转发到所有关心RouteKey中指定Topic的Queue上。这种模式较为复杂，需要RouteKey，也许要提前绑定Exchange与Queue。
```

4. 架构中引入消息队列是否利大于弊？你认为消息队列有哪些缺点？
```
我认为在架构中引入消息队列是需要考虑实际情况而定的，得根据实际情况进行判断是利大还是弊大。如果当前系统的痛点在于由于系统经常故障且耦合严重或者是当前的架构无法支持高并发的数据交互，我认为在架构中引入消息队列是利大于弊的。

而对于消息队列的缺点，我认为有以下几个：
1. 增加消息队列后系统复杂度会提升，需要维护和关注的组件会增多
2. 系统的可靠性相对降低，因为消息队列故障，比如队列积压，内存占用等问题也会导致系统故障
3. 请求的响应时间可能会增加，因为请求的处理链路变长了
```